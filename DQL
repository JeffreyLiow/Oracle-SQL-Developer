/* Addition */
select policy_rrp + policy_tp from table;
select policy_rrp,policy_tp,(policy_rrp+policy_tp) as TotalAccount from table;

/* top 10 policy_rrp */
select * from table where policy_rrp is not null order by policy_rrp desc fetch next 10 rows only;

/* According custom order */
select cust_countrycode,count(*) from table group by cust_countrycode 
order by decode(cust_countrycode,'VN',1,'HK',2,'ID',3,'MY',4,'PH',5,'TW',6,'TH',7);

/* Limit one row */
select * from table A where rownum=1
union all 
select * from table B where rownum=1
;

/* search imei result where salesrep_id not null */
select * from table A where imei in 
('1','2') and sales_rep_id is not null
union all
select * from table B where imei in 
('1','2') and sales_rep_id is not null
union all 
select * from table C where imei in 
('1','2') and sales_rep_id is not null
;

/* search policynumber that have more than 1 */
select count(policynumber), policynumber from table group by policynumber having count(policynumber)>1;

/* search policynumber that not in another table */
select * from table A where policynumber not in (select policy_id from table B);

/* Join Table where clause */
select * from tableA A
left join tableB B on
A.store_code=B.store_code
where (a.created_date > to_date('20/12/2021','dd/mm/yyyy') and
a.created_date <= to_date('31/12/2021','dd/mm/yyyy')) and
a.store_code is not null and
a.policy_imei in ('1','2','3')
;

----------------------------------------  2nd

/* First time charge */
select servicecontractnumber,ordernumber,timestamp,orderstatus from table
where timestamp < to_date('01/02/2021','dd/mm/yyyy')
order by servicecontractnumber,timestamp;

/* Calculate month of difference first charge till now vs the actual count */
select servicecontractnumber, min(timestamp), max(timestamp), (round(months_between(current_timestamp,min(timestamp)))+1) as diff_first_last_mth ,count(timestamp) from table
group by servicecontractnumber;

/* Based on 4/1/22 till 4/2/22 (Last time charge) */
select servicecontractnumber,ordernumber,timestamp,orderstatus from table
where timestamp >= to_date('04/01/2022','dd/mm/yyyy') and
timestamp < to_date('04/02/2022','dd/mm/yyyy')
order by servicecontractnumber,timestamp;
